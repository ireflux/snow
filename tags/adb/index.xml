<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Adb on sherry's blog</title><link>https://ireflux.github.io/snow/tags/adb/</link><description>Recent content in Adb on sherry's blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 02 May 2019 00:00:00 +0000</lastBuildDate><atom:link href="https://ireflux.github.io/snow/tags/adb/index.xml" rel="self" type="application/rss+xml"/><item><title>Linux上adb的使用记录</title><link>https://ireflux.github.io/snow/post/adb-use-record-on-linux/</link><pubDate>Thu, 02 May 2019 00:00:00 +0000</pubDate><guid>https://ireflux.github.io/snow/post/adb-use-record-on-linux/</guid><description>&lt;h2 id="前言"&gt;前言
&lt;/h2&gt;&lt;p&gt;我对手机的需求不高，不打游戏，只需要续航，有 Google 服务以及 root 就足够了。之前一直使用的 ADUI 的 Global 版本，再加上 Magisk 的 root 管理，配上冰箱也足以应付诸如微信这一类的国产毒瘤了。但之前有一次升级到 Pie 的大版本更新，把我的 root 覆盖掉了。因此，不得不重新再刷入 Magisk。不过 MIUI11 官方说会加入应用冻结的功能，这样一来我连 root 的需求似乎也没有了 /笑&lt;/p&gt;
&lt;p&gt;言归正传，在 Linux 上使用 adb 有些机型还是需要做一些配置，不然 &lt;code&gt;adb devices&lt;/code&gt; 会显示：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;List of devices attached&lt;br&gt;
[device name] unauthorized&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;要进行配置之前，首先需要找到自己手机的 USB vendor ID 和 product ID，启用开发者模式，然后打开 usb 调试模式插上手机后在 terminal 中执行：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ lsusb
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;它将会显示出好几条类似 &lt;code&gt;Bus xxx Device xxx: ID xxxx:xxxx &lt;/code&gt; 的东西，根据后面显示的公司信息很容易分辨出自己的手机是哪一个，ID 之后的 &lt;code&gt;xxxx：xxxx&lt;/code&gt;，前者是 vendor id，后者是 product id&lt;/p&gt;
&lt;p&gt;下面有两种方式来写配置文件：&lt;/p&gt;
&lt;h3 id="添加udev规则"&gt;添加udev规则
&lt;/h3&gt;&lt;p&gt;1.首先要确保系统中有安装 &lt;code&gt;android-udev&lt;/code&gt; 这个包。可以通过包管理器来安装或者访问&lt;a class="link" href="https://source.android.com/setup/build/initializing#configuring-usb-access" target="_blank" rel="noopener"
&gt;source.android.com&lt;/a&gt;来手动安装。在这里新建一个文件：&lt;code&gt;/etc/udev/rules.d/51-android.rules&lt;/code&gt;，然后写入以下配置，只需修改其中的 vendor id 和 product id 为自己的即可:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;SUBSYSTEM==&amp;ldquo;usb&amp;rdquo;, ATTR{idVendor}==&amp;quot;[VENDOR ID]&amp;quot;, MODE=&amp;ldquo;0660&amp;rdquo;, GROUP=&amp;ldquo;adbusers&amp;rdquo;&lt;br&gt;
SUBSYSTEM==&amp;ldquo;usb&amp;rdquo;,ATTR{idVendor}==&amp;quot;[VENDOR ID]&amp;quot;,ATTR{idProduct}==&amp;quot;[PRODUCT ID]&amp;quot;,SYMLINK+=&amp;ldquo;android_adb&amp;rdquo;&lt;br&gt;
SUBSYSTEM==&amp;ldquo;usb&amp;rdquo;,ATTR{idVendor}==&amp;quot;[VENDOR ID]&amp;quot;,ATTR{idProduct}==&amp;quot;[PRODUCT ID]&amp;quot;,SYMLINK+=&amp;ldquo;android_fastboot&amp;rdquo;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;2.然后重新载入新的配置文件：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ sudo udevadm control --reload-rules
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;3.然后将当前的用户添加到 &lt;code&gt;adbusers&lt;/code&gt; 这个组里：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ sudo gpasswd -a user group
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="配置adb"&gt;配置adb
&lt;/h3&gt;&lt;p&gt;在这个位置创建文件 &lt;code&gt;~/.android/adb_usb.ini&lt;/code&gt; ，然后将 vendor id 写入到里面，保存退出即可。&lt;/p&gt;
&lt;p&gt;这两种方式任选其一即可。然后进入解压后的 platform-tools 目录，将下好的 twrp 也放到里面，在目录中启动 terminal，然后执行：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ ./adb devices
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这样的话，应该就能看到设备被列出来了，类似于这样：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;List of devices attached&lt;br&gt;
[device name] device&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这样就算是完成了。&lt;/p&gt;
&lt;h2 id="后记"&gt;后记
&lt;/h2&gt;&lt;p&gt;我自己使用的是第二种方式，能够成功找到adb。&lt;code&gt;adb reboot bootloader&lt;/code&gt; 后进入 bootloader 也能通过 &lt;code&gt;fastboot devices&lt;/code&gt; 找到设备，然而通过 &lt;code&gt;fastboot flash recovery xxxx.img&lt;/code&gt; 就会莫名其妙的卡住&amp;hellip;通过 &lt;code&gt;fastboot boot xxxx.img&lt;/code&gt; 想要直接进入 twrp 也会卡在 sending&amp;hellip;这里。不知道是什么原因，先挖个坑，以后再慢慢研究好了。&lt;/p&gt;
&lt;h2 id="参考资料"&gt;参考资料
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;a class="link" href="https://wiki.archlinux.org/index.php/Android_Debug_Bridge" target="_blank" rel="noopener"
&gt;Android Debug Bridge&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description></item></channel></rss>